<!DOCTYPE html>
<!-- ê²Œì‹œê¸€ ìƒì„¸ë³´ê¸° + ì‘ì„±ìë§Œ ì±„íƒ ê¸°ëŠ¥ + ì‘ì„±ìëŠ” ìˆ˜ì • ë° ì‚­ì œê°€ëŠ¥ + ì‘ì„±ìê°€ ì•„ë‹ˆë©´ ë‹µë³€ ê°€ëŠ¥ -->
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${board.title}">ê²Œì‹œê¸€ ì œëª©</title>
    <style>
        body { background-color: white; color: #000; font-family: 'Segoe UI', sans-serif; padding: 40px; }
        .back-link { display: inline-block; margin-bottom: 40px; font-size: 15px; text-decoration: none; color: #5555ff; }
        .back-link:hover { text-decoration: underline; }
        .post-container { max-width: 800px; margin: 0 auto; }
        .post-title { font-size: 28px; font-weight: bold; }
        .post-meta { font-size: 14px; color: #888; margin-bottom: 20px; }
        .post-content { font-size: 16px; line-height: 1.8; white-space: pre-wrap; }
        .answer-section { margin-top: 60px; border-top: 1px solid #ccc; padding-top: 30px; }
        .answer-item { margin-bottom: 20px; padding: 10px; border: 1px solid #ddd; border-radius: 6px; }
        .answer-meta { font-size: 13px; color: #777; margin-bottom: 5px; }
        .answer-selected { color: green; font-weight: bold; }
        .control-buttons { margin-top: 20px; text-align: center; }
        .control-buttons form, .control-buttons a { display: inline-block; margin: 0 10px; }
    </style>
</head>
<body>
    <a th:href="@{/getBoardList}" class="back-link">â† ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
    <!-- ë§í¬ ë³µì‚¬ ë²„íŠ¼ -->
    <a href="#" id="btnCopyLink" class="back-link" style="float: right; margin-bottom: 40px;">ë§í¬ ë³µì‚¬</a>

    <div class="post-container">
        <div class="post-title" th:text="${board.title}">ì œëª©</div>
        <div class="post-meta">
            <span th:text="${board.member.id}">ì‘ì„±ìID</span> Â·
            <span th:text="${#dates.format(board.createDate,'yyyy-MM-dd HH:mm:ss')}">ì‘ì„±ì¼</span>
        </div>
        <div class="post-content" th:text="${board.content}">ë‚´ìš© í‘œì‹œ</div>

        <!-- ë‹µë³€ ëª©ë¡ -->
        <div class="answer-section">
            <h3>ğŸ’¬ ë‹µë³€ ëª©ë¡</h3>
            <div th:if="${#lists.isEmpty(answers)}"><p>ì•„ì§ ë“±ë¡ëœ ë‹µë³€ì´ ì—†ìŠµë‹ˆë‹¤.</p></div>
            <div th:each="answer: ${answers}" class="answer-item">
                <div class="answer-meta">
                    <span th:text="${answer.writerId}">ë‹µë³€ìID</span>
                    <span th:if="${answer.selected}" class="answer-selected"> ì±„íƒë¨</span>
                </div>
                <div th:text="${answer.content}">ë‹µë³€ ë‚´ìš©</div>
                <form th:if="${session.user != null and session.user.id == board.member.id and !answer.selected}" th:action="@{'/answer/select/' + ${answer.id}}" method="post">
                    <button type="submit">ì´ ë‹µë³€ ì±„íƒí•˜ê¸°</button>
                </form>
            </div>
        </div>

        <!-- ë‹µë³€ ë“±ë¡ í¼ -->
        <div class="answer-section" th:if="${session.user != null and session.user.id != board.member.id}">
            <h3>âœï¸ ë‹µë³€ ì‘ì„±</h3>
            <form th:action="@{/answer/add}" method="post" style="display:inline-block; vertical-align: top;">
                <input type="hidden" name="boardId" th:value="${board.seq}" />
                <textarea name="content" rows="4" cols="60" placeholder="ë‹µë³€ì„ ì…ë ¥í•˜ì„¸ìš”" required></textarea><br>
                <button type="submit">ë‹µë³€ ë“±ë¡</button>
            </form>
            <!-- ì°¨ë‹¨ ë²„íŠ¼ ë¶„ë¦¬: ë…ë¦½ í¼ -->
            <form th:action="@{/blacklist/add}" method="post" style="display:inline-block; margin-left:10px; vertical-align: top;">
                <input type="hidden" name="blockedId" th:value="${board.member.id}" />
                <button type="submit">ì°¨ë‹¨</button>
            </form>
        </div>

        <!-- ìˆ˜ì •/ì‚­ì œ ë²„íŠ¼: ì‘ì„±ìë§Œ -->
        <div class="control-buttons" th:if="${session.user != null and session.user.id == board.member.id}">
            <a th:href="@{/editBoard(seq=${board.seq})}"><button type="button">ìˆ˜ì •</button></a>
            <form th:action="@{/deleteBoard}" method="post" style="display:inline-block; margin-left:10px;">
                <input type="hidden" name="seq" th:value="${board.seq}" />
                <button type="submit" onclick="return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">ì‚­ì œ</button>
            </form>
        </div>
    </div>

    <!-- ë§í¬ ë³µì‚¬ ê¸°ëŠ¥ ìŠ¤í¬ë¦½íŠ¸ -->
    <script th:inline="javascript">
    /*<![CDATA[*/
      document.getElementById('btnCopyLink').addEventListener('click', function(e) {
        e.preventDefault();
        const url = window.location.href;
        navigator.clipboard.writeText(url)
          .then(function() {
            alert('í˜„ì¬ ê²Œì‹œê¸€ URLì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤:\n' + url);
          })
          .catch(function(err) {
            console.error('ë³µì‚¬ ì‹¤íŒ¨:', err);
            alert('ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
          });
      });
    /*]]>*/
    </script>
</body>
</html>
